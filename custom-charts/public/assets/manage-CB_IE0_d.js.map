{"version":3,"file":"manage-CB_IE0_d.js","names":[],"sources":["../../src/styles/manage.css","../../src/pages/manage/main.tsx"],"sourcesContent":[":root{ --primary:#0077FF; --border:#E5E5E5; --bg:#FAFAFA; --text:#333; --muted:#666 }\nbody{ margin:0; font:14px -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial; color:var(--text) }\n.topbar{ display:flex; gap:12px; padding:12px 16px; border-bottom:1px solid var(--border); background:#fff; position:sticky; top:0 }\n.btn{ padding:6px 12px; border:1px solid var(--border); border-radius:4px; background:#fff; cursor:pointer }\n.btn.primary{ background:var(--primary); color:#fff; border-color:var(--primary) }\n.search{ flex:1 }\n.grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(280px,1fr)); gap:20px; padding:20px }\n.card{\n  background:#fff;\n  border:1px solid var(--border);\n  border-radius:8px;\n  box-shadow:0 2px 12px rgba(0,0,0,.08);\n  padding:0;\n  display:flex;\n  flex-direction:column;\n  aspect-ratio: 4/5;\n  overflow: hidden;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.card:hover{\n  box-shadow:0 4px 20px rgba(0,0,0,.12);\n  transform: translateY(-2px);\n  border-color: var(--primary);\n}\n.row{ display:flex; justify-content:space-between; align-items:center; gap:8px; padding:0 12px }\n.meta{ font-size:11px; color:var(--muted); padding:0 12px; line-height:1.5 }\n.tags{ display:flex; gap:6px; flex-wrap:wrap; padding:0 12px 12px }\n.tag{ font-size:11px; padding:2px 6px; background:#f3f4f6; border:1px solid var(--border); border-radius:4px }\n\n/* Chart Preview Styles - 65% of card height */\n.card .preview {\n  width: 100%;\n  height: 65%;\n  background: #f8f9fa;\n  overflow: hidden;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-bottom: 1px solid var(--border);\n  flex-shrink: 0;\n}\n\n.card .preview img {\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  background: white;\n}\n\n.card .preview.placeholder {\n  background: linear-gradient(135deg, #0077FF 0%, #0055CC 100%);\n  color: white;\n  font-size: 64px;\n  flex-direction: column;\n  gap: 8px;\n}\n\n/* Content area - 35% of card height */\n.card > div:not(.preview) {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  padding: 8px 0;\n  overflow-y: auto;\n  min-height: 0;\n}\n\n","import { useEffect, useMemo, useState } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport { ensureInit, getCharts, removeChart, STORAGE_KEYS, storage } from '@/shared/storage'\nimport '@/styles/manage.css'\n\nensureInit()\n\ntype Chart = ReturnType<typeof getCharts>[number]\n\nfunction fmt(s?: string){ try{ return s? new Date(s).toLocaleString(): '' }catch{ return s||'' } }\n\nfunction App(){\n  const [q, setQ] = useState('')\n  const [charts, setCharts] = useState<Chart[]>([])\n  const [type, setType] = useState('')\n  const [sortBy, setSortBy] = useState<'updatedAt'|'createdAt'>('updatedAt')\n\n  useEffect(()=>{ setCharts(getCharts()) },[])\n\n  const filtered = useMemo(()=>{\n    return [...charts]\n      .filter(c => !q || (c.name||'').toLowerCase().includes(q.toLowerCase()))\n      .filter(c => !type || c.chartType===type)\n      .sort((a,b)=> (b[sortBy]||'').localeCompare(a[sortBy]||''))\n  },[charts,q,type,sortBy])\n\n  function onDelete(id: string){\n    if(!confirm('Á°ÆËÆ§Âà†Èô§ËØ•ÂõæË°®ÂêóÔºü')) return\n    const next = removeChart(id)\n    setCharts(next as any)\n  }\n\n  function addTag(c: Chart){\n    const t = prompt('Êñ∞Ê†áÁ≠æ')\n    if(!t) return\n    const list = storage.load<any[]>(STORAGE_KEYS.CHARTS, [])\n    const i = list.findIndex((x:any)=>x.id===c.id)\n    if(i>=0){\n      const tags = Array.from(new Set([...(list[i].tags||[]), t]))\n      list[i] = { ...list[i], tags }\n      storage.save(STORAGE_KEYS.CHARTS, list)\n      setCharts(getCharts())\n    }\n  }\n\n  function openEditor(chartId: string){\n    // Try to communicate with parent frame first, fallback to direct navigation\n    if(window.parent && window.parent !== window){\n      window.parent.postMessage({type: 'OPEN_CUSTOM_CHARTS', which: 'editor', chartId}, '*');\n    } else {\n      window.location.href = `/editor.html?id=${chartId}`;\n    }\n  }\n\n  return (\n    <div>\n      <div className='topbar'>\n        <button className='btn primary' onClick={()=> {\n          // Try to communicate with parent frame first, fallback to direct navigation\n          if(window.parent && window.parent !== window){\n            window.parent.postMessage({type: 'OPEN_CUSTOM_CHARTS', which: 'editor'}, '*');\n          } else {\n            window.location.href = '/editor.html';\n          }\n        }}>ÂàõÂª∫ÂõæË°®</button>\n        <input className='search' placeholder='ÊêúÁ¥¢ÂõæË°®ÂêçÁß∞‚Ä¶' value={q} onChange={e=>setQ(e.target.value)} />\n        <select className='btn' value={type} onChange={e=>setType(e.target.value)}>\n          <option value=''>ÂõæË°®Á±ªÂûã</option>\n          {['table','bar','line','pie','scatter','heatmap','area','radar'].map(t=> <option key={t} value={t}>{t}</option>)}\n        </select>\n        <select className='btn' value={sortBy} onChange={e=>setSortBy(e.target.value as any)}>\n          <option value='updatedAt'>Êåâ‰øÆÊîπÊó∂Èó¥</option>\n          <option value='createdAt'>ÊåâÂàõÂª∫Êó∂Èó¥</option>\n        </select>\n      </div>\n      <div className='grid'>\n        {filtered.map(c=> (\n          <div className='card' key={c.id} onClick={()=> openEditor(c.id)}>\n            {/* Chart Preview - 80% */}\n            {c.previewImage ? (\n              <div className='preview'>\n                <img src={c.previewImage} alt={c.name||'chart preview'} />\n              </div>\n            ) : (\n              <div className='preview placeholder'>\n                <span>üìä</span>\n                <span style={{fontSize: 14, marginTop: 8}}>{c.chartType||'chart'}</span>\n              </div>\n            )}\n\n            {/* Content Area - 20% */}\n            <div>\n              <div className='row' style={{marginTop: 4}}>\n                <strong style={{fontSize: 13}}>{c.name||'(Êú™ÂëΩÂêç)'}</strong>\n                <div>\n                  <button className='btn' style={{padding: '4px 8px', fontSize: 12}} onClick={(e)=> {e.stopPropagation(); openEditor(c.id)}}>‰øÆÊîπ</button>{' '}\n                  <button className='btn' style={{padding: '4px 8px', fontSize: 12}} onClick={(e)=> {e.stopPropagation(); onDelete(c.id)}}>Âà†Èô§</button>\n                </div>\n              </div>\n              <div className='meta'>{c.chartType||'bar'} ¬∑ {c.publishStatus||'draft'}</div>\n              <div className='meta'>{fmt(c.updatedAt)}</div>\n              <div className='tags'>\n                {(c.tags||[]).map((t:string)=> <span className='tag' key={t}>{t}</span>)}\n                <button className='btn' style={{padding: '2px 6px', fontSize: 11}} onClick={(e)=> {e.stopPropagation(); addTag(c)}}>+</button>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  )\n}\n\ncreateRoot(document.getElementById('root')!).render(<App />)\n\n"],"mappings":"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"}